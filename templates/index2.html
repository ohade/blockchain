<html>
<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<script>
[
	{
		"inputs": [
			{
				"internalType": "address[3]",
				"name": "projectOwners",
				"type": "address[3]"
			},
			{
				"internalType": "uint256",
				"name": "durationInSeconds",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "goalAmount",
				"type": "uint256"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "address",
				"name": "contributor",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "currentTotal",
				"type": "uint256"
			}
		],
		"name": "FundingReceived",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "address",
				"name": "recipient",
				"type": "address"
			}
		],
		"name": "fundsWithdrawn",
		"type": "event"
	},
	{
		"inputs": [],
		"name": "amountGoal",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "completeAt",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "contribute",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "contributions",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "currentBalance",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getDetails",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "deadline",
				"type": "uint256"
			},
			{
				"internalType": "enum CrowdfundingProject.State",
				"name": "currentState",
				"type": "uint8"
			},
			{
				"internalType": "uint256",
				"name": "currentAmount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "goalAmount",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getRefund",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "raiseBy",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "state",
		"outputs": [
			{
				"internalType": "enum CrowdfundingProject.State",
				"name": "",
				"type": "uint8"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "title",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "bytes32",
				"name": "_msgHash",
				"type": "bytes32"
			},
			{
				"internalType": "uint8[2]",
				"name": "_v",
				"type": "uint8[2]"
			},
			{
				"internalType": "bytes32[2]",
				"name": "_r",
				"type": "bytes32[2]"
			},
			{
				"internalType": "bytes32[2]",
				"name": "_s",
				"type": "bytes32[2]"
			}
		],
		"name": "withdrawFunds",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "payable",
		"type": "function"
	}
]

const bytecode = "60806040526000600860006101000a81548160ff0219169083600381111562000051577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b02179055503480156200006357600080fd5b5060405162001fbf38038062001fbf833981810160405281019062000089919062000598565b6200009a84620001b560201b60201c565b620000dc576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620000d390620006b4565b60405180910390fd5b6000821162000122576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620001199062000692565b60405180910390fd5b6000811162000168576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016200015f90620006d6565b60405180910390fd5b8360009060036200017b92919062000330565b50826007908051906020019062000194929190620003b2565b50816006819055508060038190555060006005819055505050505062000a20565b600080600090505b60038160ff161015620003255760001515600b6000858460ff16600381106200020f577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161515141562000304576001600b6000858460ff1660038110620002a8577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b602002015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506200030f565b60009150506200032b565b80806200031c906200087e565b915050620001bd565b50600190505b919050565b82600381019282156200039f579160200282015b828111156200039e5782518260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055509160200191906001019062000344565b5b509050620003ae919062000443565b5090565b828054620003c09062000812565b90600052602060002090601f016020900481019282620003e4576000855562000430565b82601f10620003ff57805160ff191683800117855562000430565b8280016001018555821562000430579182015b828111156200042f57825182559160200191906001019062000412565b5b5090506200043f919062000443565b5090565b5b808211156200045e57600081600090555060010162000444565b5090565b600062000479620004738462000721565b620006f8565b905080828560208602820111156200049057600080fd5b60005b85811015620004c45781620004a9888262000513565b84526020840193506020830192505060018101905062000493565b5050509392505050565b6000620004e5620004df846200074a565b620006f8565b905082815260208101848484011115620004fe57600080fd5b6200050b848285620007dc565b509392505050565b6000815190506200052481620009ec565b92915050565b600082601f8301126200053c57600080fd5b60036200054b84828562000462565b91505092915050565b600082601f8301126200056657600080fd5b815162000578848260208601620004ce565b91505092915050565b600081519050620005928162000a06565b92915050565b60008060008060c08587031215620005af57600080fd5b6000620005bf878288016200052a565b945050606085015167ffffffffffffffff811115620005dd57600080fd5b620005eb8782880162000554565b9350506080620005fe8782880162000581565b92505060a0620006118782880162000581565b91505092959194509250565b60006200062c601d8362000780565b915062000639826200094b565b602082019050919050565b600062000653601e8362000780565b9150620006608262000974565b602082019050919050565b60006200067a60228362000780565b915062000687826200099d565b604082019050919050565b60006020820190508181036000830152620006ad816200061d565b9050919050565b60006020820190508181036000830152620006cf8162000644565b9050919050565b60006020820190508181036000830152620006f1816200066b565b9050919050565b60006200070462000717565b905062000712828262000848565b919050565b6000604051905090565b600067ffffffffffffffff8211156200073f576200073e6200090b565b5b602082029050919050565b600067ffffffffffffffff8211156200076857620007676200090b565b5b62000773826200093a565b9050602081019050919050565b600082825260208201905092915050565b60006200079e82620007a5565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600060ff82169050919050565b60005b83811015620007fc578082015181840152602081019050620007df565b838111156200080c576000848401525b50505050565b600060028204905060018216806200082b57607f821691505b60208210811415620008425762000841620008dc565b5b50919050565b62000853826200093a565b810181811067ffffffffffffffff821117156200087557620008746200090b565b5b80604052505050565b60006200088b82620007cf565b915060ff821415620008a257620008a1620008ad565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6000601f19601f8301169050919050565b7f6475726174696f6e206e6565647320746f20626520706f736974697665000000600082015250565b7f6e65656420746f206861766520332064697374696e6374206f776e6572730000600082015250565b7f616d6f756e74546f5261697365206e6565647320746f20626520706f7369746960008201527f7665000000000000000000000000000000000000000000000000000000000000602082015250565b620009f78162000791565b811462000a0357600080fd5b50565b62000a1181620007c5565b811462000a1d57600080fd5b50565b61158f8062000a306000396000f3fe6080604052600436106100a75760003560e01c8063ad32f6b111610064578063ad32f6b1146101ac578063b2d5ae44146101e9578063c19d93fb14610214578063ce845d1d1461023f578063d7bb99ba1461026a578063fbbf93a014610274576100a7565b80630785001c146100ac57806337f944cc146100d757806342e94c90146101025780634a79d50c1461013f5780634c4cea5a1461016a57806386f3258614610195575b600080fd5b3480156100b857600080fd5b506100c16102a3565b6040516100ce9190611186565b60405180910390f35b3480156100e357600080fd5b506100ec6102a9565b6040516100f99190611186565b60405180910390f35b34801561010e57600080fd5b5061012960048036038101906101249190610f1e565b6102af565b6040516101369190611186565b60405180910390f35b34801561014b57600080fd5b506101546102c7565b604051610161919061110a565b60405180910390f35b34801561017657600080fd5b5061017f610355565b60405161018c9190611186565b60405180910390f35b3480156101a157600080fd5b506101aa61035b565b005b3480156101b857600080fd5b506101d360048036038101906101ce9190610f47565b610422565b6040516101e0919061108f565b60405180910390f35b3480156101f557600080fd5b506101fe6107ff565b60405161020b919061108f565b60405180910390f35b34801561022057600080fd5b50610229610a13565b60405161023691906110ef565b60405180910390f35b34801561024b57600080fd5b50610254610a26565b6040516102619190611186565b60405180910390f35b610272610a2c565b005b34801561028057600080fd5b50610289610bb6565b60405161029a95949392919061112c565b60405180910390f35b60035481565b60065481565b60096020528060005260406000206000915090505481565b600780546102d4906113a6565b80601f0160208091040260200160405190810160405280929190818152602001828054610300906113a6565b801561034d5780601f106103225761010080835404028352916020019161034d565b820191906000526020600020905b81548152906001019060200180831161033057829003601f168201915b505050505081565b60045481565b600354600554106103bc576002600860006101000a81548160ff021916908360038111156103b2577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b0217905550610419565b600654421115610418576001600860006101000a81548160ff02191690836003811115610412577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b02179055505b5b42600481905550565b6000600280600381111561045f577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600860009054906101000a900460ff1660038111156104a7577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b146104b157600080fd5b6000805b60028160ff1610156106ad5760005b60038160ff1610156106995760011515600a60008360ff1660ff16815260200190815260200160002060009054906101000a900460ff161515141561050857610686565b6001151561063760008360ff166003811061054c577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168b8b8660ff16600281106105ab577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b60200201518b8760ff16600281106105ec577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b60200201518b8860ff166002811061062d577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b6020020151610c73565b15151415610685576001600a60008360ff1660ff16815260200190815260200160002060006101000a81548160ff02191690831515021790555060018361067e9190611284565b9250610699565b5b808061069190611409565b9150506104c4565b5080806106a590611409565b9150506104b5565b5060028160ff1614156107f0576000600554905060006005819055503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f1935050505015610796577f3260f73ea642f393c831152e7e9a097f6c4e05631a49e5c5882321b7b01cfea933604051610732919061103d565b60405180910390a16003600860006101000a81548160ff02191690836003811115610786577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b02179055506001935050506107f6565b806005819055506002600860006101000a81548160ff021916908360038111156107e9577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b0217905550505b60009250505b50949350505050565b6000600180600381111561083c577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600860009054906101000a900460ff166003811115610884577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b1461088e57600080fd5b6000600960003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054116108da57600080fd5b6000600960003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490506000600960003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050156109bb5780600560008282546109af91906112bb565b92505081905550610a09565b80600960003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506000925050610a0f565b60019250505b5090565b600860009054906101000a900460ff1681565b60055481565b6000806003811115610a67577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600860009054906101000a900460ff166003811115610aaf577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b14610ab957600080fd5b610ac233610cfd565b15610acc57600080fd5b34600960003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054610b17919061122e565b600960003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555034600554610b68919061122e565b6005819055507f5cdc4ab8d637538ead6cc1904d4160343656c8c82bd266635cfd31ac008fffe03334600554604051610ba393929190611058565b60405180910390a1610bb361035b565b50565b606060008060008060078054610bcb906113a6565b80601f0160208091040260200160405190810160405280929190818152602001828054610bf7906113a6565b8015610c445780601f10610c1957610100808354040283529160200191610c44565b820191906000526020600020905b815481529060010190602001808311610c2757829003601f168201915b505050505094506006549350600860009054906101000a900460ff169250600554915060035490509091929394565b60008573ffffffffffffffffffffffffffffffffffffffff1660018686868660405160008152602001604052604051610caf94939291906110aa565b6020604051602081039080840390855afa158015610cd1573d6000803e3d6000fd5b5050506020604051035173ffffffffffffffffffffffffffffffffffffffff1614905095945050505050565b600080600090505b60038160ff161015610dc0578273ffffffffffffffffffffffffffffffffffffffff1660008260ff1660038110610d65577f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610dad576001915050610dc6565b8080610db890611409565b915050610d05565b50600090505b919050565b6000610dde610dd9846111c6565b6111a1565b90508082856020860282011115610df457600080fd5b60005b85811015610e245781610e0a8882610ef4565b845260208401935060208301925050600181019050610df7565b5050509392505050565b6000610e41610e3c846111ec565b6111a1565b90508082856020860282011115610e5757600080fd5b60005b85811015610e875781610e6d8882610f09565b845260208401935060208301925050600181019050610e5a565b5050509392505050565b600081359050610ea081611514565b92915050565b600082601f830112610eb757600080fd5b6002610ec4848285610dcb565b91505092915050565b600082601f830112610ede57600080fd5b6002610eeb848285610e2e565b91505092915050565b600081359050610f038161152b565b92915050565b600081359050610f1881611542565b92915050565b600060208284031215610f3057600080fd5b6000610f3e84828501610e91565b91505092915050565b60008060008060e08587031215610f5d57600080fd5b6000610f6b87828801610ef4565b9450506020610f7c87828801610ecd565b9350506060610f8d87828801610ea6565b92505060a0610f9e87828801610ea6565b91505092959194509250565b610fb3816112ef565b82525050565b610fc281611301565b82525050565b610fd18161130d565b82525050565b610fe081611361565b82525050565b6000610ff182611212565b610ffb818561121d565b935061100b818560208601611373565b611014816114ef565b840191505092915050565b6110288161134a565b82525050565b61103781611354565b82525050565b60006020820190506110526000830184610faa565b92915050565b600060608201905061106d6000830186610faa565b61107a602083018561101f565b611087604083018461101f565b949350505050565b60006020820190506110a46000830184610fb9565b92915050565b60006080820190506110bf6000830187610fc8565b6110cc602083018661102e565b6110d96040830185610fc8565b6110e66060830184610fc8565b95945050505050565b60006020820190506111046000830184610fd7565b92915050565b600060208201905081810360008301526111248184610fe6565b905092915050565b600060a08201905081810360008301526111468188610fe6565b9050611155602083018761101f565b6111626040830186610fd7565b61116f606083018561101f565b61117c608083018461101f565b9695505050505050565b600060208201905061119b600083018461101f565b92915050565b60006111ab6111bc565b90506111b782826113d8565b919050565b6000604051905090565b600067ffffffffffffffff8211156111e1576111e06114c0565b5b602082029050919050565b600067ffffffffffffffff821115611207576112066114c0565b5b602082029050919050565b600081519050919050565b600082825260208201905092915050565b60006112398261134a565b91506112448361134a565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0382111561127957611278611433565b5b828201905092915050565b600061128f82611354565b915061129a83611354565b92508260ff038211156112b0576112af611433565b5b828201905092915050565b60006112c68261134a565b91506112d18361134a565b9250828210156112e4576112e3611433565b5b828203905092915050565b60006112fa8261132a565b9050919050565b60008115159050919050565b6000819050919050565b600081905061132582611500565b919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600060ff82169050919050565b600061136c82611317565b9050919050565b60005b83811015611391578082015181840152602081019050611376565b838111156113a0576000848401525b50505050565b600060028204905060018216806113be57607f821691505b602082108114156113d2576113d1611491565b5b50919050565b6113e1826114ef565b810181811067ffffffffffffffff82111715611400576113ff6114c0565b5b80604052505050565b600061141482611354565b915060ff82141561142857611427611433565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6000601f19601f8301169050919050565b6004811061151157611510611462565b5b50565b61151d816112ef565b811461152857600080fd5b50565b6115348161130d565b811461153f57600080fd5b50565b61154b81611354565b811461155657600080fd5b5056fea2646970667358221220113370667e532ef8ed97fb2b94896b3860b1a5980cb99313cc1fb0f37c3804e564736f6c63430008040033"

// const Web3 = require("web3")
// this.web3 = new Web3(window.web3.currentProvider);
// this.state = {isConnected: false};
// this.handleDonateClick = this.handleDonateClick.bind(this);
// this.refreshCampaignsList = this.refreshCampaignsList.bind(this);
// this.deployCampaginToBlockChain = this.deployCampaginToBlockChain.bind(this);
// this.refundNow = this.refundNow.bind(this)
// this.signConstantMessage = this.signConstantMessage.bind(this)
// this.withdraw = this.withdraw.bind(this)
//
// window.ethereum.enable();
// console.log('provider: ', window.web3.currentProvider.enable());
// this.setState({isConnected: true});

window.addEventListener('load', async () => {
    // Modern dapp browsers...
    if (window.ethereum) {
        window.web3 = new Web3(ethereum);
    }
    // Legacy dapp browsers...
    else if (window.web3) {
        window.web3 = new Web3(web3.currentProvider);
        // Acccounts always exposed
        // web3.eth.sendTransaction({/* ... */});
    }
    // Non-dapp browsers...
    else {
        console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');
    }

    // this is done when starting the application
    try {
        // Request account access if needed
        await ethereum.enable();
        // Accounts now exposed, use them
        window.web3.eth.getAccounts().then((accounts) => {
                console.log('accounts: ', accounts[0]);
                window.deployAccount = accounts[0];
              })
        // web3.eth.sendTransaction({ /* ... */})

        // Request account access if needed
        // await ethereum.enable();
        // Acccounts now exposed
        // web3.eth.sendTransaction({/* ... */});
    } catch (error) {
        // User denied account access...
    }
});
// let campaignContractAddress;

function handleNewCampaign() {
    console.log('running handleNewCampaign')
    let address1 = "0x6Fda45F1E261f74750E152aCb5aeF708961a04bb";
    let address2 = "0x5e6798c5E6C9A4e5a0E1Dc8Ccc5B18d09d1A595A";
    let address3 = "0xf2872219f3dDdac34B37fa3098596dc4a91E3106";
    let contract = new window.web3.eth.Contract(abi);
    const pks = [address1, address2, address3]

    contract.deploy({from: window.deployAccount, gas: 1000000, data: bytecode, arguments: [pks, "ohad first contract", 3, 1000]})
    .send({from: window.deployAccount})
    .then(response => {
      console.log('response deploy: ', response)
      console.log('response deploy address: ', response.options.address)
      console.log('here3');

      window.campaignContractAddress = response.options.address;
      // const data = { name: this.state.name, address: response.options.address, relativeTimeSeconds: this.state.relativeTimeSeconds, endTime: Date.now() + 1000 * this.state.relativeTimeSeconds, goal: this.state.goal };
      // axios.post('http://localhost:5000/startNewCampaign', data)
      //     .then(response =>
      //        console.log('response post: ', response));
      //     setTimeout(function(f){
      //       f();
    })
    .catch(console.log);
    // .catch(function(e) {
    //     console.log(e);
    //     console.log(e.code);
    //     console.log(e.message);
    //     // const data = e.data;
    //     // const txHash = Object.keys(data)[0]; // TODO improve
    //     // const reason = data[txHash].reason;
    //     // console.log(reason); // prints "This is error message"
    // });

}

function handleDonateToCampaign() {
    console.log('running handleDonateToCampaign')
    // user chooses from a drop down manu that shows the names of each campaign, how much it needs and the goal.
    // when he chooses a name, I get here the address to the campaign he has chosen.
    // campaignContractAddress
    let contract = new window.web3.eth.Contract(abi, window.campaignContractAddress);
    let donation = 30;

    contract.methods.contribute().send({
        from: window.deployAccount,
        value: donation
    });
      //     .then((contributeRes) => {
      //
      //   console.log('donation returned: ', contributeRes)
      //   this.web3.eth.getBalance(this.state.contractAddress).then(balance =>
      //   {
      //     console.log('balance returned: ', balance)
      //     this.state.balance = balance;
      //     this.setState(({}));
      //   });
      //
      // });
}

let r1;
let v1;
let s1;

let r2;
let v2;
let s2;

function signConstantMessage() {
    const message = "WITHDRAW!";
// privateKey1 & privateKey2 are provided by the user in a specific field:
    let privateKey1 = "181ae9f7b98a628d1e1fbda6a8534f2d0a1c117907219965038e7248cef71a24";
    let privateKey2 = "2550c4d11beb73bbe185bbebb2464efcc2e90423d7fb0698f9ed1082f631fb56";

    const signature1 = window.web3.eth.accounts.sign(message, privateKey1);
    console.log("signature1 :", signature1);
    r1 = signature1.r;
    v1 = signature1.v;
    s1 = signature1.s;

    const signature2 = window.web3.eth.accounts.sign(message, privateKey2);
    console.log("signature2 :", signature2);
    r2 = signature2.r;
    v2 = signature2.v;
    s2 = signature2.s;

    console.log("r1, v1, s1:", r1, " ", v1, " ", s1)
    console.log("r2, v21, s2:", r2, " ", v2, " ", s2)    
}


  function handleWithdrawFromCampaign() {
    console.log('running handleWithdrawFromCampaign');
    let myContract = new window.web3.eth.Contract(abi, window.campaignContractAddress);
    console.log('withdraw now', window.campaignContractAddress);
    
    const message = "WITHDRAW!";
    const messageHash= window.web3.eth.accounts.hashMessage(message);

    const vs = [v1, v2];
    const rs = [r1, r2];
    const ss = [s1, s2];
  
    console.log('my accounts: ', window.deployAccount)
    myContract.methods.withdrawFunds(messageHash, vs, rs, ss).send({
      from: window.deployAccount
    }).then((fundsRes) => {
      
      console.log('donation returned: ', fundsRes)
      window.web3.eth.getBalance(window.campaignContractAddress).then(balance =>
      {
        console.log('balance returned: ', balance)
        window.state.balance = balance;
        window.setState(({}));
      });
      
    });
  }

  function handleGetRefundFromCampaign() {
      console.log('running handleWithdrawFromCampaign');

      let myContract = new window.web3.eth.Contract(abi, window.campaignContractAddress);
      console.log('refund now', window.campaignContractAddress)

      console.log('my accounts: ', window.deployAccount)
      myContract.methods.getRefund().send({
          from: window.deployAccount
      }).then((refundRes) => {

          console.log('donation returned: ', refundRes)
          window.web3.eth.getBalance(window.campaignContractAddress).then(balance => {
              console.log('balance returned: ', balance)
          });

      });
  }
</script>


<body>
Hey there.
<button id="newCampaign">Create new Campaign.</button>
<button id="donateCampaign">Donate to Campaign.</button>
<button id="withdrawCampaign">Withdraw from Campaign.</button>
<button id="getRefundFromCampaign">Get refund from Campaign.</button>
</body>
</html>
<script>
    document.getElementById("newCampaign").addEventListener("click", handleNewCampaign);
    document.getElementById("donateCampaign").addEventListener("click", handleDonateToCampaign);
    document.getElementById("withdrawCampaign").addEventListener("click", handleWithdrawFromCampaign);
    document.getElementById("getRefundFromCampaign").addEventListener("click", handleGetRefundFromCampaign);
</script>




<!--    -->

<!--class App extends Component {-->
<!--  constructor(props) {-->
<!--    super(props);-->
<!--    this.state = {isConnected: false};-->
<!--    this.web3 = new Web3(window.web3.currentProvider);-->

<!--    this.handleDonateClick = this.handleDonateClick.bind(this);-->
<!--    this.refreshCampaignsList = this.refreshCampaignsList.bind(this);-->
<!--    this.deployCampaginToBlockChain = this.deployCampaginToBlockChain.bind(this);-->
<!--    this.refundNow = this.refundNow.bind(this)-->
<!--    this.signConstantMessage = this.signConstantMessage.bind(this)-->
<!--    this.withdraw = this.withdraw.bind(this)-->
<!--  }-->

<!--  componentWillMount() {-->
<!--    if(this.web3) {-->
<!--      console.log('yay in ')-->
<!--      window.ethereum.enable();-->
<!--      console.log('provider: ', window.web3.currentProvider.enable());-->
<!--      this.setState({isConnected: true});-->

<!--    this.web3.eth.getAccounts().then((accounts) => {-->
<!--        console.log('accounts: ', accounts[0])-->
<!--        this.state.account = accounts[0];-->
<!--        this.setState(({}));-->
<!--      })-->
<!--    }-->
<!--  }-->

<!--  withdraw() {-->

<!--    console.log('here333')-->
<!--    let myContract = new this.web3.eth.Contract(abi, this.state.contractAddress);-->
<!--    console.log('withdraw now', this.state.contractAddress)-->
<!--    -->
<!--    const message = "WITHDRAW!";-->
<!--    const messageHash= this.web3.eth.accounts.hashMessage(message);-->

<!--    const vs = [this.state.v1, this.state.v2]-->
<!--    const rs = [this.state.r1, this.state.r2]-->
<!--    const ss = [this.state.s1, this.state.s2]-->
<!--  -->
<!--    console.log('my accounts: ', this.state.account)-->
<!--    myContract.methods.claimFunds(messageHash, vs, rs, ss).send({-->
<!--      from: this.state.account-->
<!--    }).then((claimFundsRes) => {-->
<!--      -->
<!--      console.log('donation returned: ', claimFundsRes)-->
<!--      this.web3.eth.getBalance(this.state.contractAddress).then(balance => -->
<!--      {-->
<!--        console.log('balance returned: ', balance)-->
<!--        this.state.balance = balance;-->
<!--        this.setState(({}));-->
<!--      });-->
<!--      -->
<!--    });-->


<!--  this.state.balance = null;-->
<!--  this.setState(({}));-->
<!--    -->
<!--  }-->


<!--  refundNow() {-->
<!--    let myContract = new this.web3.eth.Contract(abi, this.state.contractAddress);-->
<!--    console.log('refund now', this.state.contractAddress)-->
<!--  -->
<!--    console.log('my accounts: ', this.state.account)-->
<!--    myContract.methods.getRefund().send({-->
<!--      from: this.state.account-->
<!--    }).then((refundRes) => {-->
<!--      -->
<!--      console.log('donation returned: ', refundRes)-->
<!--      this.web3.eth.getBalance(this.state.contractAddress).then(balance => -->
<!--      {-->
<!--        console.log('balance returned: ', balance)-->
<!--        this.state.balance = balance;-->
<!--        this.setState(({}));-->
<!--      });-->
<!--      -->
<!--    });-->


<!--  this.state.balance = null;-->
<!--   this.setState(({}));-->
<!--  }-->

<!--  deployCampaginToBlockChain(){-->
<!--    -->
<!--    let SampleContract = new this.web3.eth.Contract(abi);-->
<!--    const pks = [this.state.publicKey1, this.state.publicKey2, this.state.publicKey3]-->
<!--    SampleContract.deploy({from: this.state.account, gas: 1000000, data: rawByteCode, arguments: [this.state.relativeTimeSeconds, this.state.goal, pks]})-->
<!--    .send({from: this.state.account})-->
<!--    .then(response => {-->
<!--      console.log('response deploy: ', response)-->
<!--      console.log('response deploy address: ', response.options.address)-->
<!--      console.log('here3') -->
<!--      const data = { name: this.state.name, address: response.options.address, relativeTimeSeconds: this.state.relativeTimeSeconds, endTime: Date.now() + 1000 * this.state.relativeTimeSeconds, goal: this.state.goal };-->
<!--      axios.post('http://localhost:5000/startNewCampaign', data)-->
<!--          .then(response =>-->
<!--             console.log('response post: ', response));-->
<!--          setTimeout(function(f){-->
<!--            f();-->
<!--          }, 1000, this.refreshCampaignsList);-->
<!--             -->

<!--    })-->
<!--  }-->

<!--  refreshCampaignsList() {-->
<!--    console.log('refresh campaigns');-->
<!--    fetch('http://localhost:5000/getCampaigns')-->
<!--        .then(response => response.json())-->
<!--        .then(campaigns => {-->
<!--          console.log('campaigns data: ', campaigns)-->
<!--          this.state.campaigns = campaigns.map((campaign, idx) => {-->
<!--            return <li key={idx}>name: {campaign.name}-&#45;&#45;&#45;&#45;campagin address: {campaign.address}-&#45;&#45;&#45;&#45;campaign goal: {campaign.goal}-&#45;&#45;&#45;&#45;end time: {new Date(campaign.endTime).toLocaleDateString() + ' ' + new Date(campaign.endTime).toLocaleTimeString()}</li>;-->
<!--          });-->
<!--      -->
<!--          console.log('capmaigns: ', this.state.campaigns)-->
<!--          this.setState(({}));-->
<!--        }-->
<!--      );-->
<!--  }-->

<!--  handleDonateClick() {-->

<!--    let myContract = new this.web3.eth.Contract(abi, this.state.contractAddress);-->

<!--    // const amount = 1000000000000000000-->
<!--    // const amount2 = 10000-->

<!--    console.log('contract address: ', this.state.contractAddress)-->
<!--    console.log('donation size: ', this.state.donationSize)-->
<!--    this.web3.eth.getAccounts().then((accounts) => {-->
<!--      console.log('my accounts: ', accounts[0])-->
<!--      myContract.methods.pledge().send({-->
<!--        from: accounts[0],-->
<!--        value: this.state.donationSize-->
<!--      }).then((contributeRes) => {-->
<!--        -->
<!--        console.log('donation returned: ', contributeRes)-->
<!--        this.web3.eth.getBalance(this.state.contractAddress).then(balance => -->
<!--        {-->
<!--          console.log('balance returned: ', balance)-->
<!--          this.state.balance = balance;-->
<!--          this.setState(({}));-->
<!--        });-->
<!--        -->
<!--      });-->
<!--    })-->

<!--  this.state.balance = null;-->
<!--   this.setState(({}));-->
<!--  }-->

<!--  signConstantMessage() {-->
<!--    const message = "WITHDRAW!";-->
<!--      -->
<!--    const signature1 = this.web3.eth.accounts.sign(message, this.state.private_key1);-->
<!--    const signature2 = this.web3.eth.accounts.sign(message, this.state.private_key2);-->
<!--    -->
<!--    console.log("signature1 :", signature1);-->
<!--    console.log("signature2 :", signature2);-->


<!--    this.state.r1_from_test = signature1.r;-->
<!--    this.state.v1_from_test = signature1.v;-->
<!--    this.state.s1_from_test = signature1.s;-->

<!--    this.state.r2_from_test = signature2.r;-->
<!--    this.state.v2_from_test = signature2.v;-->
<!--    this.state.s2_from_test = signature2.s;  -->
<!--    this.setState(({}));-->
<!--        -->
<!--  }-->

<!--  -->
<!--  render() {-->
<!--    return (-->
<!--      <div>-->
<!--        <h2>Is connected?:</h2><br/>-->
<!--        {this.state.isConnected? 'Connewcted to idc node':'Not Connected'}-->
<!--        <br/><br/>-->
<!--    -->


<!--        <h2>Campaigns list:</h2>-->
<!--        <ul> {this.state.campaigns} </ul>,-->

<!--        <button onClick={this.refreshCampaignsList}>-->
<!--          refresh campaigns list-->
<!--        </button>-->

<!--        <br/><br/>-->

<!--        <h2>Donate Money:</h2><br/>-->


<!--        Donation size-->
<!--        <input onChange={(e) => {-->
<!--          this.state.donationSize = Number(e.target.value)-->
<!--          console.log('donation size: ', this.state.donationSize)-->
<!--          }}/>-->

<!--         <br/>-->
<!--         -->
<!--        Address-->
<!--        <input onChange={(e) => {-->
<!--          this.state.contractAddress = e.target.value-->
<!--          console.log('contract address: ', this.state.contractAddress)-->
<!--          }}/>-->
<!--         <br/>-->
<!--         -->
<!--        <button onClick={this.handleDonateClick}>-->
<!--          Donate money-->
<!--        </button>-->

<!--        {'   '}Contract balance after donation:{' '} {this.state.balance}-->

<!--        <br/>-->
<!--        <h2>start new campaign:</h2><br/>-->
<!--        name-->
<!--        <input onChange={(e) => {-->
<!--          this.state.name = e.target.value-->
<!--          }}/>-->
<!--         <br/>-->
<!--        address 1-->
<!--        <input onChange={(e) => {-->
<!--          this.state.publicKey1 = e.target.value-->
<!--          }}/>-->
<!--         <br/>-->
<!--        address 2-->
<!--        <input onChange={(e) => {-->
<!--          this.state.publicKey2 = e.target.value-->
<!--          }}/>-->
<!--         <br/>-->
<!--         address 3-->
<!--        <input onChange={(e) => {-->
<!--          this.state.publicKey3 = e.target.value-->
<!--          }}/>-->
<!--         <br/>-->
<!--         relative time in seconds for campaign to finish                             -->
<!--         <input onChange={(e) => {-->
<!--          this.state.relativeTimeSeconds = Number(e.target.value)-->
<!--          this.setState(({}));-->
<!--          }}/>-->
<!--         <br/>-->
<!--         goal-->
<!--         <input onChange={(e) => {-->
<!--          this.state.goal = Number(e.target.value)-->
<!--          this.setState(({}));-->
<!--          }}/>-->
<!--          <br/>-->

<!--        <button onClick={this.deployCampaginToBlockChain}>-->
<!--          publish campaign-->
<!--        </button>-->

<!--        <br/><br/>-->
<!--        <h2>REFUND:</h2>-->
<!--        Address-->
<!--        <input onChange={(e) => {-->
<!--          this.state.contractAddress = e.target.value-->
<!--          console.log('contract address: ', this.state.contractAddress)-->
<!--          }}/>-->
<!--        <button onClick={this.refundNow}>-->
<!--          refund-->
<!--        </button>-->
<!--        {'   '}Contract balance after refund:{' '} {this.state.balance}-->

<!--        <br/><br/>-->
<!--        <h2>WITHDRAW:</h2>-->
<!--        Address-->
<!--        <input onChange={(e) => {-->
<!--          this.state.contractAddress = e.target.value-->
<!--          console.log('contract address: ', this.state.contractAddress)-->
<!--          }}/>-->
<!--        <br/>-->

<!--        r1-->
<!--        <input onChange={(e) => {-->
<!--          this.state.r1 = e.target.value-->
<!--          }}/>-->
<!--        <br/>-->
<!--        -->
<!--        s1-->
<!--        <input onChange={(e) => {-->
<!--          this.state.s1 = e.target.value-->
<!--          }}/>  -->
<!--        <br/>-->
<!--          -->
<!--        v1-->
<!--        <input onChange={(e) => {-->
<!--          this.state.v1 = e.target.value-->
<!--          }}/>  -->
<!--        <br/>-->
<!--        r2-->
<!--        <input onChange={(e) => {-->
<!--          this.state.r2 = e.target.value-->
<!--          }}/>-->
<!--        <br/>-->
<!--        s2-->
<!--        <input onChange={(e) => {-->
<!--          this.state.s2 = e.target.value-->
<!--          }}/>  -->
<!--        <br/> -->
<!--        v2-->
<!--        <input onChange={(e) => {-->
<!--          this.state.v2 = e.target.value-->
<!--          }}/>          -->
<!--        <br/>-->
<!--        <button onClick={this.withdraw}>-->
<!--        WITHDRAW-->
<!--        </button>-->
<!--        {'   '}Contract balance after refund:{' '} {this.state.balance}-->


<!--      <br/><br/>-->
<!--      <h2>test withdraw:</h2> <br/>for dev reasons<br/>-->
<!--      This acts as if you are passing the values of v,r,s (the seperation of the signature to three parts via some communication that is not ethereum and blockchain )-->
<!--      <br/>-->
<!--      test private key1 (without leading 0x)-->
<!--        <input onChange={(e) => {-->
<!--          this.state.private_key1 = e.target.value-->
<!--          }}/>  -->
<!--        <br/>-->
<!--     -->
<!--          -->
<!--        test private key2 (without leading 0x)-->
<!--        <input onChange={(e) => {-->
<!--          this.state.private_key2 = e.target.value-->
<!--          }}/>  -->
<!--        <br/>-->
<!--        <br/>-->
<!--        {'r1: '} {this.state.r1_from_test}-->
<!--        <br/>-->
<!--        {'rs: '} {this.state.s1_from_test}-->
<!--        <br/>-->
<!--        {'v1: '} {this.web3.utils.toDecimal(this.state.v1_from_test)}-->
<!--        <br/>-->
<!--        {'r2: '} {this.state.r2_from_test}-->
<!--        <br/>-->
<!--        {'s2: '} {this.state.s2_from_test}-->
<!--        <br/>-->
<!--        {'v2: '} {this.web3.utils.toDecimal(this.state.v2_from_test)}-->

<!--        <br/>-->

<!--      <button onClick={this.signConstantMessage}>-->
<!--      sign constant messag-->
<!--      </button>-->

<!--      </div>-->


<!--      -->
<!--    );-->
<!--  }-->
<!--}-->